<html>
<head>
	<title>Dice demo</title>

	<script src="jquery-1.6.2.js"></script>

	<meta charset="utf-8">

	<script>
	$(function() {
		var stopAttackRollID = 0;
		var stopDefenceRollID;

		function animateDice(noAttackDice, noDefenceDice){
			//Don't reaminate if dice are already spinning
			if (stopAttackRollID != 0){return;}
			
			if (noAttackDice == 1){
				$("#attackDie1").fadeTo(500, 0.4);
				$("#attackDie2").fadeTo(500, 0);
				$("#attackDie3").fadeTo(500, 0);
				stopAttackRollID = setInterval(function() { rollAttackDice([$("#attackDie1")]); }, 250);
			}
			if (noAttackDice == 2){
				$("#attackDie1").fadeTo(500, 0.4);
				$("#attackDie2").fadeTo(500, 0.4);
				$("#attackDie3").fadeTo(500, 0);
				stopAttackRollID = setInterval(function() { rollAttackDice([$("#attackDie1"), $("#attackDie2")]); }, 250);
			}
			if (noAttackDice == 3){
				$("#attackDie1").fadeTo(500, 0.4);
				$("#attackDie2").fadeTo(500, 0.4);
				$("#attackDie3").fadeTo(500, 0.4);
				stopAttackRollID = setInterval(function() { rollAttackDice([$("#attackDie1"), $("#attackDie2"), $("#attackDie3")]); }, 250);
			}
			
			if (noDefenceDice == 1){
				$("#defenceDie1").fadeTo(500, 0.4);
				$("#defenceDie2").fadeTo(500, 0);
				stopDefenceRollID = setInterval(function() { rollDefenceDice([$("#defenceDie1")]); }, 250);
			}
			if (noDefenceDice == 2){
				$("#defenceDie1").fadeTo(500, 0.4);
				$("#defenceDie2").fadeTo(500, 0.4);
				stopDefenceRollID = setInterval(function() { rollDefenceDice([$("#defenceDie1"), $("#defenceDie2")]); }, 250);
			}
		}

		function rollAttackDice(diceArray){
			var i = 0;
			for (i=0;i<diceArray.length;i++){
				var randomNum = Math.ceil(Math.random()*6);
				diceArray[i].attr("src", "White" + randomNum + "blur.svg");
			}
		}
		function rollDefenceDice(diceArray){
			var i = 0;
			for (i=0;i<diceArray.length;i++){
				var randomNum = Math.ceil(Math.random()*6);
				diceArray[i].attr("src", "Red" + randomNum + "blur.svg");
			}
		}
		
		function animateDie(objDie){
			objDie.fadeTo(500, 0.4);
			stopRollID = setInterval(function() { rollDie(objDie); }, 100);
		}
		
		function rollDie(objDie){
			var randomNum = Math.ceil(Math.random()*6);
			objDie.attr("src", "White" + randomNum + "blur.svg");
		}
		
		function stopDice(attack1, attack2, attack3, defence1, defence2){
			clearInterval(stopAttackRollID);
			clearInterval(stopDefenceRollID);
			
			stopAttackRollID = 0;
						
			$("#attackDie1").attr("src", "White" + attack1 + ".svg");
			$("#attackDie2").attr("src", "White" + attack2 + ".svg");
			$("#attackDie3").attr("src", "White" + attack3 + ".svg");
					
			$("#defenceDie1").attr("src", "Red" + defence1 + ".svg");
			$("#defenceDie2").attr("src", "Red" + defence2 + ".svg");
			
			$("#attackDie1").fadeTo(500, 1);
			if (attack2 != 0) {$("#attackDie2").fadeTo(500, 1);}
			if (attack3 != 0) {$("#attackDie3").fadeTo(500, 1);}
			
			$("#defenceDie1").fadeTo(500, 1);
			if (defence2 != 0) {$("#defenceDie2").fadeTo(500, 1);}
		}
		
		$("#start").click(function() {
			animateDice(3,2);
			return false;
		})
		
		$( "#stop" ).click(function() {
			stopDice(2, 3, 4, 5, 6);
			return false;
		});
	});
	</script>
</head>

<body>
<a href="#" id="start">START</a>
<a href="#" id="stop">STOP</a>

<div id="attackDice">
	<img id="attackDie1" src="White1.svg">
	<img id="attackDie2" src="White1.svg">
	<img id="attackDie3" src="White1.svg">
</div>

</div id="defenceDice">
	<img id="defenceDie1" src="Red1.svg">
	<img id="defenceDie2" src="Red1.svg">
<div>

</body>
</html>