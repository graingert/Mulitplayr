{% extends "fluid.html" %}

{% block head %}
<script src="/static/playbase.js"></script>
<script>
	$(document).ready(function(){
		$.templates.player_list =
			Handlebars.compile($("#player-list-template").html());

		$("#refresh").click(function(event){
			$.game.trigger("refresh");
			event.preventDefault();
		});
	})
	$.game.on("new-state", function(event, state){
		$(".current-player").text(state["current_player"]);
		$(".current-state").text(state["state"]);
		$("#player-list").html($($.templates.player_list(state)))
	});
</script>
{% raw %}
<script id="player-list-template" type="text/x-handlebars-template">
	{{#each players}}
	<li>
	{{this.nickname}}
	{{#if this.active}}
	(active)
	{{/if}}
	</li>
	{{/each}}
</script>
{% endraw %}
{% endblock %}

{% block sidebar %}
<dl>
	<dt>Current Player</dt>
	<dd class="current-player"></dd>
	<dt>State</dt>
	<dd class="current-state"></dd>
</dl>
<h2>Players</h2>
<ul id="player-list">
</ul>
<a id="refresh" class="btn" href="#">Refresh State</a>
{% endblock %}

{% block content %}
{% endblock %}
